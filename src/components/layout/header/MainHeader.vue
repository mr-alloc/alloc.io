<template>
  <header class="bg-background/75 backdrop-blur border-b border-gray-200 dark:border-gray-800 -mb-px sticky top-0 z-50 lg:mb-0 lg:border-0">
    <div id="main-header" class="mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl flex items-center justify-between gap-3 h-[--header-height]" :class="{
      'search-mode' : searchStatusStore.isSearchMode,
    }">
      <div class="lg:flex-1 flex items-center gap-1.5" @click="router.push('/')">
        <div class="relative inline-flex text-left rtl:text-right">
          <div class="inline-flex w-full">
            <NuxtLink href="/" class="flex gap-2 items-end">
              <!--          <img src="/assets/dev_is_record.png" :style="{-->
              <!--              width: '100%',-->
              <!--              cursor: 'pointer'-->
              <!--          }" />-->
              <svg class="text-black dark:text-white block w-auto h-6" xmlns="http://www.w3.org/2000/svg" width="150" height="60" viewBox="0 0 150 60" fill="none">
                <path d="M0 0 C2.875 1.4375 2.875 1.4375 5 4 C5.59211632 7.78819873 5.73608419 11.52783162 4 15 C3.60772162 17.70872518 3.25430502 20.40751693 2.9375 23.125 C2.84662109 23.87910156 2.75574219 24.63320313 2.66210938 25.41015625 C2.43809148 27.27304188 2.21861427 29.13647252 2 31 C2.66 31 3.32 31 4 31 C4.02578125 30.41992188 4.0515625 29.83984375 4.078125 29.2421875 C4.47334133 23.79898075 5.2729055 20.23075592 9 16 C13.37346615 13.0843559 16.78665994 12.43127199 22 13 C25.5386994 14.65139305 26.81070153 15.71605229 29 19 C29.484375 21.59375 29.484375 21.59375 29.75 24.5 C29.84796875 25.4590625 29.9459375 26.418125 30.046875 27.40625 C30 30 30 30 28 33 C27.80487894 34.93169848 27.68846259 36.8720094 27.625 38.8125 C27.14635944 45.53780555 25.38953996 48.78530443 20.4375 53.375 C15.58153702 55.67054613 11.2835299 55.80196436 6 55 C2.5 53.125 2.5 53.125 0 51 C-1.485 50.01 -1.485 50.01 -3 49 C-3.04125 49.598125 -3.0825 50.19625 -3.125 50.8125 C-4 53 -4 53 -6.75 54.875 C-10 56 -10 56 -12.75 55.375 C-15 54 -15 54 -17 51 C-16.79296875 48.0390625 -16.79296875 48.0390625 -16.1875 44.625 C-15.99542969 43.50351562 -15.80335937 42.38203125 -15.60546875 41.2265625 C-15.09005459 38.47990381 -14.55890189 35.73810653 -14 33 C-14.34256836 33.45850342 -14.68513672 33.91700684 -15.03808594 34.3894043 C-16.60786124 36.489416 -18.17892009 38.58846416 -19.75 40.6875 C-20.28882812 41.40873047 -20.82765625 42.12996094 -21.3828125 42.87304688 C-30.79272859 55.4387275 -30.79272859 55.4387275 -36.5 56.4375 C-39 56 -39 56 -41.3125 53.8125 C-43.10380798 50.82698671 -43.38888658 49.4027576 -43 46 C-43.66 46 -44.32 46 -45 46 C-45.165 46.7425 -45.33 47.485 -45.5 48.25 C-47.74310836 52.36236533 -50.57079463 53.69565133 -55 55 C-60.47669657 55.71813637 -65.95007522 55.94617231 -71 53.4375 C-74.58282854 50.52645181 -76.01547875 48.12780419 -78 44 C-78.49886719 44.45890625 -78.99773437 44.9178125 -79.51171875 45.390625 C-86.9184662 51.72026914 -95.28383111 55.00059516 -105.0625 55.5 C-109 55 -109 55 -111.5625 53.5 C-114.97013966 47.57367016 -112.55952499 39.91354095 -111.0625 33.625 C-110.78889648 32.41650391 -110.78889648 32.41650391 -110.50976562 31.18359375 C-109.15865198 25.31730396 -109.15865198 25.31730396 -108 23 C-108.99 22.67 -109.98 22.34 -111 22 C-112.114446 17.3193268 -111.9607923 14.41178268 -110 10 C-107.91238577 7.24814488 -106.33964157 6.61805055 -103 6 C-83.4691025 4.76155432 -83.4691025 4.76155432 -76 10 C-73.65225097 12.48529393 -71.75089949 15.06759923 -70 18 C-69.401875 17.525625 -68.80375 17.05125 -68.1875 16.5625 C-63.13595308 12.9542522 -56.96014999 13.38149387 -51 14 C-47.75 16 -47.75 16 -46 18 C-45.505 17.2884375 -45.505 17.2884375 -45 16.5625 C-42.02615418 14.23918295 -38.73693287 13.84937507 -35 14 C-32.79296875 14.60546875 -32.79296875 14.60546875 -31 16 C-30.390625 18.8203125 -30.390625 18.8203125 -30.25 22.125 C-30.19328125 23.22070312 -30.1365625 24.31640625 -30.078125 25.4453125 C-30.05234375 26.28835937 -30.0265625 27.13140625 -30 28 C-29.37351562 27.15695313 -28.74703125 26.31390625 -28.1015625 25.4453125 C-27.27612676 24.33847821 -26.45060124 23.23171086 -25.625 22.125 C-25.2125 21.56941406 -24.8 21.01382812 -24.375 20.44140625 C-22.6745427 18.1649876 -21.0120881 16.0120881 -19 14 C-13.66666667 13.66666667 -13.66666667 13.66666667 -11 15 C-11.04125 13.783125 -11.0825 12.56625 -11.125 11.3125 C-11.1187378 7.77435852 -10.75830059 5.14643264 -9 2 C-5.48746854 -0.34168764 -4.13530644 -0.49623677 0 0 Z M-94 23 C-94.33872513 24.41538717 -94.67074624 25.83237963 -95 27.25 C-95.185625 28.03890625 -95.37125 28.8278125 -95.5625 29.640625 C-96.12154828 32.25556002 -96.12154828 32.25556002 -96 36 C-91.05770013 34.73569073 -88.17423736 33.03993846 -85 29 C-84.74304733 26.77713532 -84.74304733 26.77713532 -86 25 C-88.93995019 22.97244814 -90.27704003 23 -94 23 Z M-45 36 C-45 38.64 -45 41.28 -45 44 C-44.67 44 -44.34 44 -44 44 C-44 41.36 -44 38.72 -44 36 C-44.33 36 -44.66 36 -45 36 Z " fill="#010803" transform="translate(117,2)"/>
                <path d="M0 0 C4.05798775 1.91691612 7.13250707 4.3329234 9.23828125 8.28125 C10.21497786 13.13682742 9.70340981 17.10272048 7.23828125 21.40625 C1.22908015 29.8090883 -5.67375137 34.03947947 -15.76171875 36.28125 C-18.58645665 36.58876423 -20.9134948 36.54995037 -23.76171875 36.28125 C-24.09171875 35.95125 -24.42171875 35.62125 -24.76171875 35.28125 C-24.22087262 28.49671179 -23.0131384 21.89049042 -21.69921875 15.21875 C-21.51294922 14.25775391 -21.32667969 13.29675781 -21.13476562 12.30664062 C-20.68026313 9.96420469 -20.22252973 7.62245156 -19.76171875 5.28125 C-21.08171875 4.95125 -22.40171875 4.62125 -23.76171875 4.28125 C-20.24374221 -3.50855519 -7.43236789 -1.93430791 0 0 Z M-9.76171875 13.28125 C-10.10044388 14.69663717 -10.43246499 16.11362963 -10.76171875 17.53125 C-10.94734375 18.32015625 -11.13296875 19.1090625 -11.32421875 19.921875 C-11.88326703 22.53681002 -11.88326703 22.53681002 -11.76171875 26.28125 C-6.81941888 25.01694073 -3.93595611 23.32118846 -0.76171875 19.28125 C-0.50476608 17.05838532 -0.50476608 17.05838532 -1.76171875 15.28125 C-4.70166894 13.25369814 -6.03875878 13.28125 -9.76171875 13.28125 Z " fill="#1FD45E" transform="translate(32.76171875,11.71875)"/>
                <path d="M0 0 C2 1.625 2 1.625 3 3.625 C3.203125 5.71875 3.203125 5.71875 3.25 8.125 C3.27578125 8.9190625 3.3015625 9.713125 3.328125 10.53125 C3.21984375 11.2221875 3.1115625 11.913125 3 12.625 C-0.79163027 15.15275351 -3.80874031 14.84943035 -8.1875 14.75 C-8.93708984 14.74097656 -9.68667969 14.73195313 -10.45898438 14.72265625 C-12.30612654 14.69912578 -14.15310412 14.66325561 -16 14.625 C-15.39816251 16.64545442 -14.72693904 18.64611039 -14 20.625 C-10.94730154 22.15134923 -8.24154311 21.46294444 -4.875 21.1875 C-2.95300781 21.03474609 -2.95300781 21.03474609 -0.9921875 20.87890625 C-0.00476563 20.79511719 0.98265625 20.71132813 2 20.625 C1.69140625 22.515625 1.69140625 22.515625 1 24.625 C-4.1623292 27.5749024 -8.10060352 28.18684728 -14 27.625 C-18.0226217 26.06064712 -19.59149109 25.23776337 -22 21.625 C-22.97185038 14.71974728 -22.64964608 8.86380157 -18.41015625 3.18359375 C-13.40602254 -2.34729088 -6.66755953 -3.05596478 0 0 Z " fill="#20D960" transform="translate(66,20.375)"/>
                <path d="M0 0 C2.4375 1.625 2.4375 1.625 4 4 C4.25 7.25 4.25 7.25 4 10 C2.35 10 0.7 10 -1 10 C-1.33 8.68 -1.66 7.36 -2 6 C-3.32 6.33 -4.64 6.66 -6 7 C-6 8.32 -6 9.64 -6 11 C-3.14748615 13.17946646 -3.14748615 13.17946646 0 15 C2 17 2 17 2.3125 19.8125 C1.95719707 23.43658984 1.27731036 25.17299404 -1 28 C-4.98806643 30.39283986 -9.45870998 30.83114176 -14 30 C-16.81376668 28.76300446 -19.00840371 27.3570268 -21 25 C-21.4375 21.6875 -21.4375 21.6875 -21 19 C-19.35 18.67 -17.7 18.34 -16 18 C-15.649375 18.804375 -15.29875 19.60875 -14.9375 20.4375 C-13.14332716 23.3867767 -13.14332716 23.3867767 -9.3125 23.8125 C-7.6728125 23.9053125 -7.6728125 23.9053125 -6 24 C-5.67 22.35 -5.34 20.7 -5 19 C-7.64 17.02 -10.28 15.04 -13 13 C-12.76150722 8.30964199 -12.6177954 5.87218174 -9.875 2 C-6.23495488 -0.5322053 -4.34960823 -0.71175407 0 0 Z " fill="#20D65F" transform="translate(138,18)"/>
                <path d="M0 0 C2.5 0.125 2.5 0.125 3.5 1.125 C3.7117387 3.75408881 3.87634379 6.36658062 4 9 C4.22527338 14.64276006 4.22527338 14.64276006 5.5 20.125 C6.08007812 19.3515625 6.66015625 18.578125 7.2578125 17.78125 C11.671875 11.89583333 16.0859375 6.01041667 20.5 0.125 C22.975 0.62 22.975 0.62 25.5 1.125 C24.89764528 4.76388263 23.41182437 6.75938259 21.0625 9.5625 C17.18122919 14.27346276 13.44186022 19.0710339 9.73852539 23.92163086 C6.59470139 28.03029861 6.59470139 28.03029861 5.5 29.125 C3.83382885 29.16563832 2.16611905 29.167721 0.5 29.125 C-2.47406069 20.20281792 -3.85215962 10.51592313 -3.5 1.125 C-2.5 0.125 -2.5 0.125 0 0 Z " fill="#1FD35D" transform="translate(78.5,18.875)"/>
                <path d="M0 0 C4.56660237 -0.37278387 8.76622048 -0.50775005 13 1.4375 C16.08806125 4.07521899 16.53997565 4.55557656 17.1875 8.3125 C17.2730134 12.03844095 16.81921182 15.17034276 14.703125 18.359375 C10.41462205 22.4905017 4.09169513 25.82800611 -1.87890625 26.16015625 C-2.57886719 26.10730469 -3.27882813 26.05445312 -4 26 C-3.46588214 17.14101063 -1.85710087 8.65479083 0 0 Z M4 9 C3.66127487 10.41538717 3.32925376 11.83237963 3 13.25 C2.814375 14.03890625 2.62875 14.8278125 2.4375 15.640625 C1.87845172 18.25556002 1.87845172 18.25556002 2 22 C6.94229987 20.73569073 9.82576264 19.03993846 13 15 C13.25695267 12.77713532 13.25695267 12.77713532 12 11 C9.06004981 8.97244814 7.72295997 9 4 9 Z " fill="#010A04" transform="translate(19,16)"/>
                <path d="M0 0 C1.65 0 3.3 0 5 0 C5.19310143 6.4495879 4.60530095 12.10734278 3.125 18.375 C2.95097656 19.16777344 2.77695313 19.96054687 2.59765625 20.77734375 C1.75850034 24.45098186 1.12988836 26.80516746 -1 30 C-3.625 30.1875 -3.625 30.1875 -6 30 C-5.20995834 23.59793828 -3.83235014 17.35690778 -2.4375 11.0625 C-2.20353516 9.99708984 -1.96957031 8.93167969 -1.72851562 7.83398438 C-1.15461421 5.22214732 -0.57838259 2.61084769 0 0 Z " fill="#1ECE5B" transform="translate(110,18)"/>
                <path d="M0 0 C0.99 0.66 1.98 1.32 3 2 C3 3.32 3 4.64 3 6 C-1.29 6 -5.58 6 -10 6 C-7.44918485 -0.37703788 -6.48085956 -0.39678732 0 0 Z " fill="#021208" transform="translate(61,24)"/>
                <path d="M0 0 C2.625 0.375 2.625 0.375 5 1 C4.67 3.31 4.34 5.62 4 8 C2.02 8.33 0.04 8.66 -2 9 C-2.125 5.625 -2.125 5.625 -2 2 C-1.34 1.34 -0.68 0.68 0 0 Z " fill="#22E365" transform="translate(112,5)"/>
                <path d="M0 0 C2.625 0.375 2.625 0.375 5 1 C1.25 3 1.25 3 -1 3 C-1 4.65 -1 6.3 -1 8 C-0.01 8.33 0.98 8.66 2 9 C0.68 9 -0.64 9 -2 9 C-2.125 5.625 -2.125 5.625 -2 2 C-1.34 1.34 -0.68 0.68 0 0 Z " fill="#1AB34F" transform="translate(112,5)"/>
              </svg>
              <div class="relative inline-flex">
                <span class="inline-flex items-center text-xs px-1.5 py-0.5 bg-primary-50 dark:bg-primary-400 dark:bg-opacity-10 text-primary-500 dark:text-primary-400 ring-1 ring-inset ring-primary-500 dark:ring-primary-400 ring-opacity-25 dark:ring-opacity-25 -mb-[2px] rounded font-semibold">
                  {{ packageJson.version }}
                </span>
              </div>
            </NuxtLink>
          </div>
        </div>
      </div>
      <ul class="items-center gap-x-8 hidden lg:flex">
        <li class="relative">
            <div class="inline-flex w-full">
              <client-only>
                <a href="/tags" class="text-sm/6 font-semibold flex items-center gap-1 text-primary">태그</a>
              </client-only>
            </div>
        </li>
      </ul>
      <div class="flex items-center justify-end lg:flex-1 gap-1.5">
        <div class="relative inline-flex">
          <button type="button" v-on:click="methods.activateSearchMode()" aria-label="Search"
                  class="focus:outline-none focus-visible:outline-0 disabled:cursor-not-allowed disabled:opacity-75 flex-shrink-0 font-medium rounded-md text-sm gap-x-1.5 p-1.5 text-gray-700 dark:text-gray-200 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800 focus-visible:ring-inset focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400 inline-flex items-center">
            <span class="iconify i-ph:magnifying-glass flex-shrink-0 h-5 w-5"></span>
          </button>
        </div>
      </div>
    </div>
  </header>
</template>
<script lang="ts" setup>
import {onMounted} from "vue";
import {useSearchStatusStore} from "@/store/SearchStatusStore";
import {usePhotoViewStatusStore} from "@/store/PhotoViewStore";
import {useNuxtApp} from "nuxt/app";
import packageJson from "~/package.json"
const router = useRouter();
const nuxtApp = useNuxtApp();
const emitter: any = nuxtApp.$emitter;

const searchStatusStore = useSearchStatusStore();
const photoViewStatus = usePhotoViewStatusStore();

onMounted(() => {
  emitter.on('initScroll', () => {
    window.scrollTo({
      top:0,
      behavior: 'smooth'
    })
  });

  emitter.on('resetSearchBar', () => {
    methods.inactivateSearchMode()
  });

});
const methods = {

  activateSearchMode: () => {
    searchStatusStore.searching();
    // const input = document.getElementById('search-bar') as HTMLInputElement
    // input.focus()
  },
  inactivateSearchMode: () => {
    const input = document.getElementById('search-bar') as HTMLInputElement
    input.value = ''
    input.blur()
    searchStatusStore.cancelSearch()
  },
}
</script>
